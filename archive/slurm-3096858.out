cpu-bind=MASK - n2gpu1202, task  0  0 [3831142]: mask |B-------|--------||--------|--------||--------|--------||--------|--------||||--------|--------||--------|--------||--------|--------||--------|--------|  set
cpu-bind=MASK - n2gpu1202, task  0  0 [3831176]: mask |B-------|--------||--------|--------||--------|--------||--------|--------||||--------|--------||--------|--------||--------|--------||--------|--------|  set
cpu-bind=MASK - n2gpu1203, task  1  0 [1055059]: mask |B-------|--------||--------|--------||--------|--------||--------|--------||||--------|--------||--------|--------||--------|--------||--------|--------|  set
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[default0]:using world size: 8, data-parallel-size: 4, tensor-model-parallel size: 2, pipeline-model-parallel size: 1 
[default0]:using torch.float16 for parameters ...
[default0]:------------------------ arguments ------------------------
[default0]:  abort_on_unmet_fused_kernel_constraints ......... False
[default0]:  accumulate_allreduce_grads_in_fp32 .............. False
[default0]:  adam_beta1 ...................................... 0.9
[default0]:  adam_beta2 ...................................... 0.95
[default0]:  adam_eps ........................................ 1e-08
[default0]:  adlr_autoresume ................................. False
[default0]:  adlr_autoresume_interval ........................ 1000
[default0]:  apply_query_key_layer_scaling ................... True
[default0]:  apply_residual_connection_post_layernorm ........ False
[default0]:  attention_dropout ............................... 0.1
[default0]:  attention_softmax_in_fp32 ....................... False
[default0]:  bert_binary_head ................................ True
[default0]:  bert_load ....................................... None
[default0]:  bf16 ............................................ False
[default0]:  bias_dropout_fusion ............................. True
[default0]:  bias_gelu_fusion ................................ True
[default0]:  biencoder_projection_dim ........................ 0
[default0]:  biencoder_shared_query_context_model ............ False
[default0]:  block_data_path ................................. None
[default0]:  checkpoint_activations .......................... True
[default0]:  checkpoint_in_cpu ............................... False
[default0]:  checkpoint_num_layers ........................... 1
[default0]:  clip_grad ....................................... 1.0
[default0]:  codecarbon_dir .................................. None
[default0]:  consumed_train_samples .......................... 0
[default0]:  consumed_train_tokens ........................... 0
[default0]:  consumed_valid_samples .......................... 0
[default0]:  contigious_checkpointing ........................ False
[default0]:  cpu_optimizer ................................... False
[default0]:  cpu_torch_adam .................................. False
[default0]:  curriculum_learning ............................. False
[default0]:  data_impl ....................................... infer
[default0]:  data_parallel_size .............................. 4
[default0]:  data_path ....................................... ['data/meg-gpt2-oscar-en-10k_text_document']
[default0]:  dataloader_type ................................. single
[default0]:  DDP_impl ........................................ local
[default0]:  decoder_seq_length .............................. None
[default0]:  deepscale ....................................... False
[default0]:  deepscale_config ................................ None
[default0]:  deepspeed ....................................... True
[default0]:  deepspeed_activation_checkpointing .............. True
[default0]:  deepspeed_config ................................ ./ds_config.json
[default0]:  deepspeed_mpi ................................... False
[default0]:  distribute_checkpointed_activations ............. False
[default0]:  distributed_backend ............................. nccl
[default0]:  embed_layernorm ................................. False
[default0]:  embedding_path .................................. None
[default0]:  encoder_seq_length .............................. 512
[default0]:  eod_mask_loss ................................... False
[default0]:  eval_interval ................................... 100
[default0]:  eval_iters ...................................... 10
[default0]:  eval_only ....................................... None
[default0]:  evidence_data_path .............................. None
[default0]:  exit_duration_in_mins ........................... None
[default0]:  exit_interval ................................... 100
[default0]:  ffn_hidden_size ................................. 32
[default0]:  finetune ........................................ False
[default0]:  fp16 ............................................ True
[default0]:  fp16_lm_cross_entropy ........................... False
[default0]:  fp32_residual_connection ........................ False
[default0]:  gigaflos_no_embeds .............................. 0
[default0]:  global_batch_size ............................... 16
[default0]:  glu_activation .................................. None
[default0]:  hidden_dropout .................................. 0.1
[default0]:  hidden_size ..................................... 8
[default0]:  hysteresis ...................................... 2
[default0]:  ict_head_size ................................... None
[default0]:  ict_load ........................................ None
[default0]:  img_dim ......................................... 224
[default0]:  indexer_batch_size .............................. 128
[default0]:  indexer_log_interval ............................ 1000
[default0]:  inference ....................................... False
[default0]:  init_method_std ................................. 0.02
[default0]:  init_method_xavier_uniform ...................... False
[default0]:  initial_loss_scale .............................. 4294967296
[default0]:  kill_switch_path ................................ None
[default0]:  kv_channels ..................................... 4
[default0]:  layernorm_epsilon ............................... 1e-05
[default0]:  lazy_mpu_init ................................... None
[default0]:  load ............................................ checkpoints/gpt2-dist
[default0]:  local_rank ...................................... None
[default0]:  log_batch_size_to_tensorboard ................... True
[default0]:  log_interval .................................... 10
[default0]:  log_learning_rate_to_tensorboard ................ True
[default0]:  log_level ....................................... None
[default0]:  log_level_replica ............................... None
[default0]:  log_loss_scale_to_tensorboard ................... True
[default0]:  log_num_zeros_in_grad ........................... False
[default0]:  log_params_norm ................................. False
[default0]:  log_path ........................................ None
[default0]:  log_timers_to_tensorboard ....................... True
[default0]:  log_validation_ppl_to_tensorboard ............... True
[default0]:  loss_on_targets_only ............................ False
[default0]:  loss_scale ...................................... None
[default0]:  loss_scale_window ............................... 1000
[default0]:  lr .............................................. 0.0001
[default0]:  lr_decay_iters .................................. None
[default0]:  lr_decay_samples ................................ 12
[default0]:  lr_decay_style .................................. cosine
[default0]:  lr_decay_tokens ................................. None
[default0]:  lr_warmup_fraction .............................. None
[default0]:  lr_warmup_iters ................................. 0
[default0]:  lr_warmup_samples ............................... 5
[default0]:  make_vocab_size_divisible_by .................... 128
[default0]:  mask_prob ....................................... 0.15
[default0]:  masked_softmax_fusion ........................... True
[default0]:  max_position_embeddings ......................... 512
[default0]:  mean_noise_span_length .......................... None
[default0]:  memory_centric_tiled_linear ..................... False
[default0]:  merge_file ...................................... data/gpt2-merges.txt
[default0]:  micro_batch_size ................................ 1
[default0]:  min_loss_scale .................................. 1.0
[default0]:  min_lr .......................................... 1e-06
[default0]:  mmap_warmup ..................................... False
[default0]:  no_load_optim ................................... None
[default0]:  no_load_rng ..................................... None
[default0]:  no_save_optim ................................... None
[default0]:  no_save_rng ..................................... None
[default0]:  noise_density ................................... None
[default0]:  num_attention_heads ............................. 2
[default0]:  num_channels .................................... 3
[default0]:  num_classes ..................................... 1000
[default0]:  num_layers ...................................... 2
[default0]:  num_layers_per_virtual_pipeline_stage ........... None
[default0]:  num_workers ..................................... 2
[default0]:  onnx_safe ....................................... None
[default0]:  openai_gelu ..................................... False
[default0]:  optimizer ....................................... adam
[default0]:  override_lr_scheduler ........................... False
[default0]:  pad_vocab_size_to ............................... None
[default0]:  params_dtype .................................... torch.float16
[default0]:  partition_activations ........................... True
[default0]:  patch_dim ....................................... 16
[default0]:  pipeline_model_parallel_size .................... 1
[default0]:  position_embedding_type ......................... PositionEmbeddingType.absolute
[default0]:  pp_partition_method ............................. None
[default0]:  profile_backward ................................ False
[default0]:  query_in_block_prob ............................. 0.1
[default0]:  rampup_batch_size ............................... ['2', '2', '1_000']
[default0]:  rank ............................................ 0
[default0]:  remote_device ................................... none
[default0]:  reset_attention_mask ............................ False
[default0]:  reset_position_ids .............................. False
[default0]:  retriever_report_topk_accuracies ................ []
[default0]:  retriever_score_scaling ......................... False
[default0]:  retriever_seq_length ............................ 256
[default0]:  reweight_loss_based_on_position_frequency ....... False
[default0]:  sample_rate ..................................... 1.0
[default0]:  save ............................................ checkpoints/gpt2-dist
[default0]:  save_interval ................................... 50
[default0]:  scatter_gather_tensors_in_pipeline .............. True
[default0]:  scattered_embeddings ............................ False
[default0]:  seed ............................................ 42
[default0]:  seq_length ...................................... 512
[default0]:  sgd_momentum .................................... 0.9
[default0]:  short_seq_prob .................................. 0.1
[default0]:  skip_train_iteration_range ...................... None
[default0]:  split ........................................... 969, 30, 1
[default0]:  split_transformers .............................. False
[default0]:  sync_tp_duplicated_parameters ................... False
[default0]:  synchronize_each_layer .......................... False
[default0]:  tensor_model_parallel_size ...................... 2
[default0]:  tensorboard_dir ................................. output_dir/tensorboard-dist
[default0]:  tensorboard_log_interval ........................ 1
[default0]:  tensorboard_queue_size .......................... 5
[default0]:  test_weighted_split_names ....................... None
[default0]:  test_weighted_split_paths ....................... None
[default0]:  test_weighted_split_paths_path .................. None
[default0]:  test_weighted_split_splits ...................... None
[default0]:  test_weighted_split_weights ..................... None
[default0]:  tile_factor ..................................... 1
[default0]:  titles_data_path ................................ None
[default0]:  tokenizer_name_or_path .......................... None
[default0]:  tokenizer_type .................................. GPT2BPETokenizer
[default0]:  train_iters ..................................... None
[default0]:  train_samples ................................... 10000
[default0]:  train_tokens .................................... None
[default0]:  train_weighted_split_paths ...................... None
[default0]:  train_weighted_split_paths_path ................. None
[default0]:  universal_checkpoint ............................ False
[default0]:  use_bnb_optimizer ............................... False
[default0]:  use_checkpoint_lr_scheduler ..................... False
[default0]:  use_contiguous_buffers_in_ddp ................... False
[default0]:  use_cpu_initialization .......................... None
[default0]:  use_one_sent_docs ............................... False
[default0]:  use_pin_memory .................................. False
[default0]:  valid_num_workers ............................... 2
[default0]:  valid_weighted_split_names ...................... None
[default0]:  valid_weighted_split_paths ...................... None
[default0]:  valid_weighted_split_paths_path ................. None
[default0]:  valid_weighted_split_splits ..................... None
[default0]:  valid_weighted_split_weights .................... None
[default0]:  virtual_pipeline_model_parallel_size ............ None
[default0]:  vocab_extra_ids ................................. 0
[default0]:  vocab_file ...................................... data/gpt2-vocab.json
[default0]:  weight_decay .................................... 0.1
[default0]:  world_size ...................................... 8
[default0]:  zero_allgather_bucket_size ...................... 0.0
[default0]:  zero_contigious_gradients ....................... False
[default0]:  zero_reduce_bucket_size ......................... 0.0
[default0]:  zero_reduce_scatter ............................. False
[default0]:  zero_stage ...................................... 1
[default0]:-------------------- end of arguments ---------------------
[default0]:will use batch size rampup starting from global batch size 2 to global batch size 16 with batch size increments 2 over 1000 samples.
[default0]:> building GPT2BPETokenizer tokenizer ...
[default0]: > padded vocab (size: 50257) with 175 dummy tokens (new size: 50432)
[default0]:DeepSpeed general environment info:
[default0]:torch install path ............... ['/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch']
[default0]:torch version .................... 1.13.1
[default0]:deepspeed install path ........... ['/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/deepspeed']
[default0]:deepspeed info ................... 0.8.2+8710f051, 8710f051, master
[default0]:torch cuda version ............... 11.7
[default0]:torch hip version ................ None
[default0]:nvcc version ..................... 11.7
[default0]:deepspeed wheel compiled w. ...... torch 1.13, cuda 11.7
[default0]:**** Git info for Megatron: git_hash=e52bdab git_branch=main ****
[default0]:> initializing torch distributed ...
[default0]:[2023-02-25 15:08:27,849] [INFO] [comm.py:657:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[default3]:> setting tensorboard ...
[default0]:> initializing tensor model parallel with size 2
[default0]:> initializing pipeline model parallel with size 1
[default0]:> setting random seeds to 42 ...
[default0]:[2023-02-25 15:09:29,656] [INFO] [checkpointing.py:226:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 2760 and data parallel seed: 42
[default0]:> compiling dataset index builder ...
[default0]:make: Entering directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/data'
[default0]:make: Nothing to be done for 'default'.
[default0]:make: Leaving directory '/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/data'
[default0]:>>> done with dataset index builder. Compilation time: 0.949 seconds
[default0]:WARNING: constraints for invoking optimized fused softmax kernel are not met. We default back to unfused kernel invocations.
[default0]:> compiling and loading fused kernels ...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_upper_triang_masked_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:[1/3] c++ -MMD -MF scaled_upper_triang_masked_softmax.o.d -DTORCH_EXTENSION_NAME=scaled_upper_triang_masked_softmax_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/scaled_upper_triang_masked_softmax.cpp -o scaled_upper_triang_masked_softmax.o 
[default0]:[2/3] /opt/software/pc2/EB-SW/software/CUDA/11.7.0/bin/nvcc  -DTORCH_EXTENSION_NAME=scaled_upper_triang_masked_softmax_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 --compiler-options '-fPIC' -O3 --use_fast_math -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda -std=c++14 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/scaled_upper_triang_masked_softmax_cuda.cu -o scaled_upper_triang_masked_softmax_cuda.cuda.o 
[default0]:[3/3] c++ scaled_upper_triang_masked_softmax.o scaled_upper_triang_masked_softmax_cuda.cuda.o -shared -L/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/opt/software/pc2/EB-SW/software/CUDA/11.7.0/lib64 -lcudart -o scaled_upper_triang_masked_softmax_cuda.so
[default0]:Loading extension module scaled_upper_triang_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module scaled_masked_softmax_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:[1/3] c++ -MMD -MF scaled_masked_softmax.o.d -DTORCH_EXTENSION_NAME=scaled_masked_softmax_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/scaled_masked_softmax.cpp -o scaled_masked_softmax.o 
WARNING:torch.distributed.elastic.rendezvous.dynamic_rendezvous:The node 'n2gpu1203.ab2021.local_1055059_0' has failed to send a keep-alive heartbeat to the rendezvous 'none' due to an error of type RendezvousTimeoutError.
[default0]:[2/3] /opt/software/pc2/EB-SW/software/CUDA/11.7.0/bin/nvcc  -DTORCH_EXTENSION_NAME=scaled_masked_softmax_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 --compiler-options '-fPIC' -O3 --use_fast_math -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda -std=c++14 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/scaled_masked_softmax_cuda.cu -o scaled_masked_softmax_cuda.cuda.o 
[default0]:[3/3] c++ scaled_masked_softmax.o scaled_masked_softmax_cuda.cuda.o -shared -L/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/opt/software/pc2/EB-SW/software/CUDA/11.7.0/lib64 -lcudart -o scaled_masked_softmax_cuda.so
[default0]:Loading extension module scaled_masked_softmax_cuda...
[default0]:Detected CUDA files, patching ldflags
[default0]:Emitting ninja build file /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/build/build.ninja...
[default0]:Building extension module fused_mix_prec_layer_norm_cuda...
[default0]:Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[default0]:[1/3] c++ -MMD -MF layer_norm_cuda.o.d -DTORCH_EXTENSION_NAME=fused_mix_prec_layer_norm_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda.cpp -o layer_norm_cuda.o 
[default0]:[2/3] /opt/software/pc2/EB-SW/software/CUDA/11.7.0/bin/nvcc  -DTORCH_EXTENSION_NAME=fused_mix_prec_layer_norm_cuda -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/TH -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/THC -isystem /opt/software/pc2/EB-SW/software/CUDA/11.7.0/include -isystem /scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 --compiler-options '-fPIC' -O3 --use_fast_math -maxrregcount=50 -std=c++14 -c /scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu -o layer_norm_cuda_kernel.cuda.o 
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In function ‘void cuda_layer_norm(at::Tensor*, at::Tensor*, at::Tensor*, at::Tensor*, int, int, c10::IntList, at::Tensor*, at::Tensor*, double)’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:224: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:247: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:272: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:296: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                        ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:359: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:414: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                              ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:119: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:142: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                              ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:167: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:191: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                               ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:258: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                  ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:317: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                             ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:131: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                   ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:154: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                          ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:179: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                   ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:203: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                           ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:274: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                  ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:337: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                 ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:151: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:174: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                              ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:199: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:227: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                   ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:294: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:353: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                 ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:166: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:189: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                             ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:214: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:246: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:317: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                             ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:706:380: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                            ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In function ‘void cuda_layer_norm_gradient(at::Tensor*, at::Tensor*, at::Tensor*, at::Tensor*, int, int, c10::IntList, at::Tensor*, at::Tensor*, double, at::Tensor*, at::Tensor*, at::Tensor*)’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:224: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:247: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:272: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:333: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                             ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:389: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:438: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:489: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:550: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:120: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                        ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:143: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                               ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:168: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                        ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:233: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                         ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:293: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:342: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                      ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:397: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                             ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:462: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:132: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                    ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:155: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                           ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:180: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                    ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:249: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                         ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:313: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                         ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:362: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                          ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:421: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:490: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:152: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                        ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:175: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                               ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:200: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                        ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:265: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                         ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:325: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:378: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                          ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:433: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                 ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:498: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:167: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:190: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                              ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:215: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                       ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:284: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                            ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:348: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                            ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:405: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:464: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:533: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     DISPATCH_FLOAT_HALF_AND_BFLOAT_INOUT_TYPES(
[default0]:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ^
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In instantiation of ‘void HostLayerNormGradient(const V*, const U*, const U*, at::Tensor*, int, int, const V*, const V*, double, T*, V*, V*) [with T = float; U = float; V = float]’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:562:   required from here
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:782:97: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     cuComputeGradInput<<<blocks1, threads1, nshared, stream>>>(
[default0]:                                                                                                 ^                                                                                       
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In instantiation of ‘void HostLayerNormGradient(const V*, const U*, const U*, at::Tensor*, int, int, const V*, const V*, double, T*, V*, V*) [with T = float; U = float; V = c10::Half]’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:474:   required from here
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:782:97: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     cuComputeGradInput<<<blocks1, threads1, nshared, stream>>>(
[default0]:                                                                                                 ^                                                                                       
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In instantiation of ‘void HostLayerNormGradient(const V*, const U*, const U*, at::Tensor*, int, int, const V*, const V*, double, T*, V*, V*) [with T = float; U = float; V = c10::BFloat16]’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:502:   required from here
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:782:97: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     cuComputeGradInput<<<blocks1, threads1, nshared, stream>>>(
[default0]:                                                                                                 ^                                                                                       
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In instantiation of ‘void HostLayerNormGradient(const V*, const U*, const U*, at::Tensor*, int, int, const V*, const V*, double, T*, V*, V*) [with T = c10::Half; U = float; V = c10::Half]’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:510:   required from here
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:782:97: warning: ‘T* at::Tensor::data() const [with T = c10::Half]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     cuComputeGradInput<<<blocks1, threads1, nshared, stream>>>(
[default0]:                                                                                                 ^                                                                                       
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu: In instantiation of ‘void HostLayerNormGradient(const V*, const U*, const U*, at::Tensor*, int, int, const V*, const V*, double, T*, V*, V*) [with T = c10::BFloat16; U = float; V = c10::BFloat16]’:
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:814:545:   required from here
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:751:106: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputePartGradGammaBeta<<<blocks2, threads2, nshared2, stream>>>(
[default0]:                                                                                                          ^                                                                                                                                               
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:764:102: warning: ‘T* at::Tensor::data() const [with T = float]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:       cuComputeGradGammaBeta<<<blocks3, threads3, nshared3, stream>>>(
[default0]:                                                                                                      ^                                                                                                                    
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:/scratch/hpc-prf-lola/nikit/repos/Megatron-DeepSpeed-BigScience/megatron/fused_kernels/layer_norm_cuda_kernel.cu:782:97: warning: ‘T* at::Tensor::data() const [with T = c10::BFloat16]’ is deprecated: Tensor.data<T>() is deprecated. Please use Tensor.data_ptr<T>() instead. [-Wdeprecated-declarations]
[default0]:     cuComputeGradInput<<<blocks1, threads1, nshared, stream>>>(
[default0]:                                                                                                 ^                                                                                       
[default0]:/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:238:1: note: declared here
[default0]:   T * data() const {
[default0]: ^ ~~
[default0]:[3/3] c++ layer_norm_cuda.o layer_norm_cuda_kernel.cuda.o -shared -L/scratch/hpc-prf-lola/lib_repo/conda-libs/envs/lola/lib/python3.9/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/opt/software/pc2/EB-SW/software/CUDA/11.7.0/lib64 -lcudart -o fused_mix_prec_layer_norm_cuda.so
[default0]:Loading extension module fused_mix_prec_layer_norm_cuda...
slurmstepd: error: *** JOB 3096858 ON n2gpu1202 CANCELLED AT 2023-02-25T15:42:55 ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
